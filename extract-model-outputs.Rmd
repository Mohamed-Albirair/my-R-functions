---
title: "Extract Model Outputs"
author: "Mohamed Albirair"
date: "9/17/2021"
output: html_document
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = TRUE, eval = TRUE, results = 'hold', warning = FALSE,
                      message = FALSE, error = FALSE, fig.height = 3.4)

pacman::p_load(tidyverse)
```

Below is a function that extracts linear models outputs (or `glm()` models with `family = "gaussian"` specification).

```{r linear model ouptut, results='hide'}

lmmod <- lm(mpg ~ cyl + gear + hp, data = mtcars)

lmOutputExtract <- function(mod){
            lmOutput <- data.frame(coefficients(summary(mod))[, c(1, 4)], confint(mod)) %>%
                  dplyr::select(1, 3, 4, 2) %>% round(., 3) %>%
                  `colnames<-`(c("Coefficient", "LCL", "UCL", "P-value")) %>%
                  mutate(`P-value` = case_when(`P-value` < 0.001 ~ "<0.001*",
                                               `P-value` < 0.05 ~ paste0(`P-value`,"*"),
                                               `P-value` >= 0.05 ~ as.character(`P-value`)))
            print(lmOutput)}
 
linearOutput <- lmOutputExtract(lmmod)
```

```{r linear modeul output formatted}
linearOuptut %>%
      knitr::kable("latex", caption = "Linear regression model output") %>%
      kableExtra::kable_styling(latex_options = c("striped", "HOLD_position"), fixed_thead = T)
```